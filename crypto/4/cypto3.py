# https://github.com/bl4de/ctf/blob/master/2017/BostonKeyParty_2017/Prudentialv2/Prudentialv2_Cloud_50.md
import requests
import hashlib
# this is copy/paste from Hex editor - two different files with the same SHA1 checksum
username = '2550 4446 2d31 2e33 0a25 e2e3 cfd3 0a0a 0a31 2030 206f 626a 0a3c 3c2f 5769 6474 6820 3220 3020 522f 4865 6967 6874 2033 2030 2052 2f54 7970 6520 3420 3020 522f 5375 6274 7970 6520 3520 3020 522f 4669 6c74 6572 2036 2030 2052 2f43 6f6c 6f72 5370 6163 6520 3720 3020 522f 4c65 6e67 7468 2038 2030 2052 2f42 6974 7350 6572 436f 6d70 6f6e 656e 7420 383e 3e0a 7374 7265 616d 0aff d8ff fe00 2453 4841 2d31 2069 7320 6465 6164 2121 2121 2185 2fec 0923 3975 9c39 b1a1 c63c 4c97 e1ff fe01 7f46 dc93 a6b6 7e01 3b02 9aaa 1db2 560b 45ca 67d6 88c7 f84b 8c4c 791f e02b 3df6 14f8 6db1 6909 01c5 6b45 c153 0afe dfb7 6038 e972 722f e7ad 728f 0e49 04e0 46c2 3057 0fe9 d413 98ab e12e f5bc 942b e335 42a4 802d 98b5 d70f 2a33 2ec3 7fac 3514 e74d dc0f 2cc1 a874 cd0c 7830 5a21 5664 6130 9789 606b d0bf 3f98 cda8 0446 29a1 3c68 746d 6c3e 0a3c 7363 7269 7074 206c 616e 6775 6167 653d 6a61 7661 7363 7269 7074 2074 7970 653d 2274 6578 742f 6a61 7661 7363 7269 7074 223e 0a3c 212d 2d20 4061 7277 202d 2d3e 0a64 6461 615f 6973 5f50 4844 0a0a 7661 7220 6820 3d20 646f 6375 6d65 6e74 2e67 6574 456c 656d 656e 7473 4279 5461 674e 616d 6528 2248 544d 4c22 295b 305d 2e69 6e6e 6572 4854 4d4c 2e63 6861 7243 6f64 6541 7428 3130 3229 2e74 6f53 7472 696e 6728 3136 293b 0a69 6620 2868 203d 3d20 2737 3327 2920 7b0a 2020 2020 646f 6375 6d65 6e74 2e62 6f64 792e 696e 6e65 7248 544d 4c20 3d20 223c 5354 594c 453e 626f 6479 7b62 6163 6b67 726f 756e 642d 636f 6c6f 723a 5245 443b 7d20 6831 7b66 6f6e 742d 7369 7a65 3a35 3030 253b 7d3c 2f53 5459 4c45 3e3c 4831 3e26 2378 3166 3634 383b 3c2f 4831 3e22 3b0a 7d20 656c 7365 207b 0a20 2020 2064 6f63 756d 656e 742e 626f 6479 2e69 6e6e 6572 4854 4d4c 203d 2022 3c53 5459 4c45 3e62 6f64 797b 6261 636b 6772 6f75 6e64 2d63 6f6c 6f72 3a42 4c55 453b 7d20 6831 7b66 6f6e 742d 7369 7a65 3a35 3030 253b 7d3c 2f53 5459 4c45 3e3c 4831 3e26 2378 3166 3634 393b 3c2f 4831 3e22 3b0a 7d0a 0a3c 2f73 6372 6970 743e 0a53 6e6f 6f70 795f 646f 5f6e 6f74 5f6c 696b 655f 6361 7473 5f68 6168 6168 6168 610a 3138 3339 3537'

password = '2550 4446 2d31 2e33 0a25 e2e3 cfd3 0a0a 0a31 2030 206f 626a 0a3c 3c2f 5769 6474 6820 3220 3020 522f 4865 6967 6874 2033 2030 2052 2f54 7970 6520 3420 3020 522f 5375 6274 7970 6520 3520 3020 522f 4669 6c74 6572 2036 2030 2052 2f43 6f6c 6f72 5370 6163 6520 3720 3020 522f 4c65 6e67 7468 2038 2030 2052 2f42 6974 7350 6572 436f 6d70 6f6e 656e 7420 383e 3e0a 7374 7265 616d 0aff d8ff fe00 2453 4841 2d31 2069 7320 6465 6164 2121 2121 2185 2fec 0923 3975 9c39 b1a1 c63c 4c97 e1ff fe01 7346 dc91 66b6 7e11 8f02 9ab6 21b2 560f f9ca 67cc a8c7 f85b a84c 7903 0c2b 3de2 18f8 6db3 a909 01d5 df45 c14f 26fe dfb3 dc38 e96a c22f e7bd 728f 0e45 bce0 46d2 3c57 0feb 1413 98bb 552e f5a0 a82b e331 fea4 8037 b8b5 d71f 0e33 2edf 93ac 3500 eb4d dc0d ecc1 a864 790c 782c 7621 5660 dd30 9791 d06b d0af 3f98 cda4 bc46 29b1 3c68 746d 6c3e 0a3c 7363 7269 7074 206c 616e 6775 6167 653d 6a61 7661 7363 7269 7074 2074 7970 653d 2274 6578 742f 6a61 7661 7363 7269 7074 223e 0a3c 212d 2d20 4061 7277 202d 2d3e 0a64 6461 615f 6973 5f50 4844 0a0a 7661 7220 6820 3d20 646f 6375 6d65 6e74 2e67 6574 456c 656d 656e 7473 4279 5461 674e 616d 6528 2248 544d 4c22 295b 305d 2e69 6e6e 6572 4854 4d4c 2e63 6861 7243 6f64 6541 7428 3130 3229 2e74 6f53 7472 696e 6728 3136 293b 0a69 6620 2868 203d 3d20 2737 3327 2920 7b0a 2020 2020 646f 6375 6d65 6e74 2e62 6f64 792e 696e 6e65 7248 544d 4c20 3d20 223c 5354 594c 453e 626f 6479 7b62 6163 6b67 726f 756e 642d 636f 6c6f 723a 5245 443b 7d20 6831 7b66 6f6e 742d 7369 7a65 3a35 3030 253b 7d3c 2f53 5459 4c45 3e3c 4831 3e26 2378 3166 3634 383b 3c2f 4831 3e22 3b0a 7d20 656c 7365 207b 0a20 2020 2064 6f63 756d 656e 742e 626f 6479 2e69 6e6e 6572 4854 4d4c 203d 2022 3c53 5459 4c45 3e62 6f64 797b 6261 636b 6772 6f75 6e64 2d63 6f6c 6f72 3a42 4c55 453b 7d20 6831 7b66 6f6e 742d 7369 7a65 3a35 3030 253b 7d3c 2f53 5459 4c45 3e3c 4831 3e26 2378 3166 3634 393b 3c2f 4831 3e22 3b0a 7d0a 0a3c 2f73 6372 6970 743e 0a53 6e6f 6f70 795f 646f 5f6e 6f74 5f6c 696b 655f 6361 7473 5f68 6168 6168 6168 610a 3138 3339 3537'

print '[+] create URL decoded strings to send as GET parameters [name] and [password]...'

name = ''.join(username.split(' '))
password = ''.join(password.split(' '))

namestr = ''.join(['%' + name[i] + name[i + 1] for i in range(0, len(name)) if i % 2 == 0])

passwordstr = ''.join(['%' + password[j] + password[j + 1] for j in range(0, len(password)) if j % 2 == 0])

#print '[+] sending request to https://quiz.ais3.org:32670/index.php'

#print namestr
payload = {'username' : namestr, 'password' : passwordstr}

print (hashlib.sha1(namestr).hexdigest())
print (hashlib.sha1(passwordstr).hexdigest())
#r= requests.post("https://quiz.ais3.org:32670/index.php", data=payload)
#print (r.content)

#u = 'http://php-vest12385905582.codeanyapp.com/ais3_crypto3.php?username={}&password={}'.format(namestr, passwordstr)
#print u
u =  'username={}&password={}'.format(namestr, passwordstr)
print u
#resp = requests.get("http://php-vest12385905582.codeanyapp.com/ais3_crypto3.php", params = payload)
#print resp.url
#print '[+] read FLAG from response...\n\n'
#print resp.content

